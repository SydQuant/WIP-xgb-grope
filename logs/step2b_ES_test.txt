2025-09-03 16:38:20,855 - __main__ - INFO - \U0001f4c4 Loaded configuration from configs/individual_target_test.yaml
2025-09-03 16:38:20,856 - __main__ - INFO - \U0001f4c4 Using configuration: configs/individual_target_test.yaml
2025-09-03 16:38:20,856 - __main__ - INFO - \U0001f680 Starting XGB Ensemble Analysis
2025-09-03 16:38:20,856 - __main__ - INFO - \U0001f3af Target symbols: ['@ES#C']
2025-09-03 16:38:20,856 - __main__ - INFO - 
================================================================================
2025-09-03 16:38:20,856 - __main__ - INFO - \U0001f504 PROCESSING TARGET 1/1: @ES#C
2025-09-03 16:38:20,857 - __main__ - INFO - ================================================================================
2025-09-03 16:38:20,857 - __main__ - INFO - \U0001f504 Loading real market data for target: @ES#C
2025-09-03 16:38:20,857 - data.data_utils_simple - INFO - Preparing data for @ES#C, period 2020-07-01 to 2024-08-01
2025-09-03 16:38:21,092 - data.data_utils_simple - INFO - Loaded data for 10 symbols
C:\Users\zhang\Desktop\Steve\bond_ls_xgb_grope_full_v6\data\data_utils_simple.py:279: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  df[target_col] = target_returns.reindex(df.index)
2025-09-03 16:38:21,769 - data.data_utils_simple - INFO - Cleaning data: (1057, 523)
2025-09-03 16:38:21,940 - data.data_utils_simple - INFO - Cleaned data: (1057, 523) (dropped 0 features)
2025-09-03 16:38:21,942 - data.data_utils_simple - INFO - Final dataset: (1057, 523), target mean=0.000496, target std=0.009404
2025-09-03 16:38:21,949 - __main__ - INFO - \u2705 Loaded data: X shape (1057, 522), y shape (1057,)
2025-09-03 16:38:21,949 - __main__ - INFO - \U0001f4c5 Date range: 2020-07-01 12:00:00 to 2024-07-31 12:00:00
2025-09-03 16:38:21,949 - __main__ - INFO - Loaded real data: X shape (1057, 522), y shape (1057,)
2025-09-03 16:38:21,949 - __main__ - INFO - Date range: 2020-07-01 12:00:00 to 2024-07-31 12:00:00
2025-09-03 16:38:21,949 - __main__ - INFO - Using CLI specified feature count: 100
2025-09-03 16:38:21,949 - __main__ - INFO - Applying smart block-wise feature selection: 522 -> 100 features
2025-09-03 16:38:21,949 - model.feature_selection - INFO - Smart block-wise selection: 522 -> blocks of 100 -> local clustering -> global deduplication
2025-09-03 16:38:21,949 - model.feature_selection - INFO - Processing block 1/6: 100 features
2025-09-03 16:38:22,398 - model.feature_selection - INFO - Block 100: Selected 15 features (best: 0.0823)
2025-09-03 16:38:22,398 - model.feature_selection - INFO - Processing block 2/6: 100 features
2025-09-03 16:38:22,833 - model.feature_selection - INFO - Block 100: Selected 15 features (best: 0.0681)
2025-09-03 16:38:22,833 - model.feature_selection - INFO - Processing block 3/6: 100 features
2025-09-03 16:38:23,260 - model.feature_selection - INFO - Block 100: Selected 15 features (best: 0.0682)
2025-09-03 16:38:23,260 - model.feature_selection - INFO - Processing block 4/6: 100 features
2025-09-03 16:38:23,685 - model.feature_selection - INFO - Block 100: Selected 15 features (best: 0.1273)
2025-09-03 16:38:23,685 - model.feature_selection - INFO - Processing block 5/6: 100 features
2025-09-03 16:38:24,157 - model.feature_selection - INFO - Block 100: Selected 15 features (best: 0.0789)
2025-09-03 16:38:24,157 - model.feature_selection - INFO - Processing block 6/6: 22 features
2025-09-03 16:38:24,391 - model.feature_selection - INFO - Block 22: Selected 8 features (best: 0.0739)
2025-09-03 16:38:24,391 - model.feature_selection - INFO - Global deduplication: 83 candidates -> removing cross-block correlations
2025-09-03 16:38:24,988 - model.feature_selection - INFO - \u2705 Smart block-wise selection complete: 75 features selected
2025-09-03 16:38:24,988 - model.feature_selection - INFO -    Local clustering: 0.7, Global clustering: 0.85
2025-09-03 16:38:24,990 - __main__ - INFO - Feature selection complete: (1057, 75)
2025-09-03 16:38:25,400 - __main__ - INFO - [Fold 0] Training data: X_tr(252, 75), y_tr(252,)
2025-09-03 16:38:25,401 - __main__ - INFO - [Fold 0] Target stats: mean=0.001273, std=0.008950
2025-09-03 16:38:25,403 - __main__ - INFO - [Fold 0] Feature stats: 528.124780 total magnitude
C:\Users\zhang\anaconda3\Lib\site-packages\xgboost\core.py:729: UserWarning: [16:38:27] WARNING: C:\actions-runner\_work\xgboost\xgboost\src\common\error_msg.cc:58: Falling back to prediction using DMatrix due to mismatched devices. This might lead to higher memory usage and slower performance. XGBoost is running on: cuda:0, while the input data is on: cpu.
Potential solutions:
- Use a data structure that matches the device ordinal in the booster.
- Set the device for booster before call to inplace_predict.

This warning will only be shown once.

  return func(**kwargs)
2025-09-03 16:39:21,984 - __main__ - INFO - Fold 0 XGBoost predictions: train_preds count=50, test_preds count=50
2025-09-03 16:39:21,985 - __main__ - INFO - Fold 0 test prediction stats: model_0: mean=0.001294, std=0.009185, range=[-0.028115, 0.027202]; model_1: mean=0.001270, std=0.009706, range=[-0.028886, 0.027794]; model_2: mean=0.001320, std=0.008638, range=[-0.025873, 0.024269]
2025-09-03 16:39:28,301 - __main__ - INFO - Fold 0: Selected 12 models, weights: ['0.929', '0.000', '0.000', '0.001', '0.000', '0.000', '0.002', '0.000', '0.000', '0.000', '0.060', '0.008'], tau: 0.200
2025-09-03 16:39:28,301 - __main__ - INFO - Fold 0 individual test signals: count=12, lengths=[176, 176, 176], magnitudes=[79.19371702525521, 80.44923260614013, 79.46549440994275]
2025-09-03 16:39:28,301 - __main__ - INFO - Fold 0 signal stats: mean=-0.010118, std=0.557689, sum=-1.780811, magnitude=79.163742
2025-09-03 16:39:28,303 - __main__ - INFO - [Fold 1] Training data: X_tr(252, 75), y_tr(252,)
2025-09-03 16:39:28,303 - __main__ - INFO - [Fold 1] Target stats: mean=0.001273, std=0.008950
2025-09-03 16:39:28,304 - __main__ - INFO - [Fold 1] Feature stats: 528.124780 total magnitude
2025-09-03 16:40:25,336 - __main__ - INFO - Fold 1 XGBoost predictions: train_preds count=50, test_preds count=50
2025-09-03 16:40:25,337 - __main__ - INFO - Fold 1 test prediction stats: model_0: mean=0.001285, std=0.004854, range=[-0.020770, 0.017256]; model_1: mean=0.001163, std=0.005231, range=[-0.020373, 0.013949]; model_2: mean=0.001200, std=0.004616, range=[-0.019189, 0.012800]
2025-09-03 16:40:31,687 - __main__ - INFO - Fold 1: Selected 12 models, weights: ['0.016', '0.000', '0.000', '0.011', '0.000', '0.000', '0.000', '0.700', '0.000', '0.009', '0.000', '0.264'], tau: 0.456
2025-09-03 16:40:31,687 - __main__ - INFO - Fold 1 individual test signals: count=12, lengths=[176, 176, 176], magnitudes=[73.7597008202032, 79.74696045820474, 75.71214561610623]
2025-09-03 16:40:31,688 - __main__ - INFO - Fold 1 signal stats: mean=-0.001788, std=0.497114, sum=-0.314617, magnitude=69.886670
2025-09-03 16:40:31,689 - __main__ - INFO - [Fold 2] Training data: X_tr(352, 75), y_tr(352,)
2025-09-03 16:40:31,689 - __main__ - INFO - [Fold 2] Target stats: mean=0.001167, std=0.008346
2025-09-03 16:40:31,691 - __main__ - INFO - [Fold 2] Feature stats: 531.480230 total magnitude
2025-09-03 16:41:31,778 - __main__ - INFO - Fold 2 XGBoost predictions: train_preds count=50, test_preds count=50
2025-09-03 16:41:31,779 - __main__ - INFO - Fold 2 test prediction stats: model_0: mean=0.003013, std=0.004855, range=[-0.012009, 0.018559]; model_1: mean=0.002096, std=0.005919, range=[-0.012514, 0.020771]; model_2: mean=0.002331, std=0.004351, range=[-0.010236, 0.012340]
2025-09-03 16:41:38,698 - __main__ - INFO - Fold 2: Selected 12 models, weights: ['0.528', '0.010', '0.000', '0.000', '0.004', '0.001', '0.457', '0.000', '0.000', '0.000', '0.000', '0.000'], tau: 0.439
2025-09-03 16:41:38,698 - __main__ - INFO - Fold 2 individual test signals: count=12, lengths=[176, 176, 176], magnitudes=[93.11926696505624, 97.1708519642988, 97.70688099753897]
2025-09-03 16:41:38,699 - __main__ - INFO - Fold 2 signal stats: mean=0.078940, std=0.530599, sum=13.893373, magnitude=76.861600
2025-09-03 16:41:38,699 - __main__ - INFO - [Fold 3] Training data: X_tr(528, 75), y_tr(528,)
2025-09-03 16:41:38,699 - __main__ - INFO - [Fold 3] Target stats: mean=0.000483, std=0.010169
2025-09-03 16:41:38,701 - __main__ - INFO - [Fold 3] Feature stats: 525.452144 total magnitude
2025-09-03 16:42:45,416 - __main__ - INFO - Fold 3 XGBoost predictions: train_preds count=50, test_preds count=50
2025-09-03 16:42:45,416 - __main__ - INFO - Fold 3 test prediction stats: model_0: mean=-0.000772, std=0.004850, range=[-0.018231, 0.010395]; model_1: mean=-0.001477, std=0.006323, range=[-0.020488, 0.017135]; model_2: mean=-0.001794, std=0.004728, range=[-0.019010, 0.012556]
2025-09-03 16:42:52,848 - __main__ - INFO - Fold 3: Selected 12 models, weights: ['0.002', '0.002', '0.000', '0.184', '0.779', '0.010', '0.000', '0.015', '0.004', '0.001', '0.003', '0.000'], tau: 0.263
2025-09-03 16:42:52,848 - __main__ - INFO - Fold 3 individual test signals: count=12, lengths=[176, 176, 176], magnitudes=[94.19199490381718, 89.73804619709776, 88.39933011179843]
2025-09-03 16:42:52,849 - __main__ - INFO - Fold 3 signal stats: mean=0.042651, std=0.561923, sum=7.506555, magnitude=84.943424
2025-09-03 16:42:52,850 - __main__ - INFO - [Fold 4] Training data: X_tr(704, 75), y_tr(704,)
2025-09-03 16:42:52,850 - __main__ - INFO - [Fold 4] Target stats: mean=0.000319, std=0.010462
2025-09-03 16:42:52,852 - __main__ - INFO - [Fold 4] Feature stats: 524.283068 total magnitude
2025-09-03 16:44:02,025 - __main__ - INFO - Fold 4 XGBoost predictions: train_preds count=50, test_preds count=50
2025-09-03 16:44:02,025 - __main__ - INFO - Fold 4 test prediction stats: model_0: mean=-0.000982, std=0.004899, range=[-0.015886, 0.010791]; model_1: mean=-0.000341, std=0.005216, range=[-0.014516, 0.012890]; model_2: mean=-0.000228, std=0.004921, range=[-0.014178, 0.012786]
2025-09-03 16:44:09,713 - __main__ - INFO - Fold 4: Selected 12 models, weights: ['0.038', '0.113', '0.104', '0.073', '0.110', '0.130', '0.112', '0.130', '0.046', '0.062', '0.039', '0.042'], tau: 3.000
2025-09-03 16:44:09,713 - __main__ - INFO - Fold 4 individual test signals: count=12, lengths=[176, 176, 176], magnitudes=[92.32475868108966, 89.55140269286724, 89.15787471454723]
2025-09-03 16:44:09,714 - __main__ - INFO - Fold 4 signal stats: mean=-0.025348, std=0.422246, sum=-4.461247, magnitude=60.134938
2025-09-03 16:44:09,715 - __main__ - INFO - [Fold 5] Training data: X_tr(880, 75), y_tr(880,)
2025-09-03 16:44:09,715 - __main__ - INFO - [Fold 5] Target stats: mean=0.000397, std=0.009850
2025-09-03 16:44:09,716 - __main__ - INFO - [Fold 5] Feature stats: 521.108994 total magnitude
2025-09-03 16:45:07,213 - __main__ - INFO - Fold 5 XGBoost predictions: train_preds count=50, test_preds count=50
2025-09-03 16:45:07,213 - __main__ - INFO - Fold 5 test prediction stats: model_0: mean=0.000316, std=0.004142, range=[-0.011755, 0.011583]; model_1: mean=0.000225, std=0.004152, range=[-0.011420, 0.014204]; model_2: mean=0.000194, std=0.004027, range=[-0.011971, 0.013351]
2025-09-03 16:45:14,679 - __main__ - INFO - Fold 5: Selected 12 models, weights: ['0.000', '0.000', '0.000', '0.000', '0.753', '0.000', '0.000', '0.000', '0.000', '0.024', '0.224', '0.000'], tau: 0.200
2025-09-03 16:45:14,679 - __main__ - INFO - Fold 5 individual test signals: count=12, lengths=[177, 177, 177], magnitudes=[97.30659014265734, 90.60145250722894, 99.71864017364206]
2025-09-03 16:45:14,680 - __main__ - INFO - Fold 5 signal stats: mean=0.031165, std=0.503521, sum=5.516256, magnitude=74.563902
2025-09-03 16:45:14,680 - __main__ - INFO - \U0001f4cb Processing complete: 6 fold summaries created
2025-09-03 16:45:14,680 - __main__ - INFO - \U0001f4ca OOS signal magnitude: 445.5542769526
2025-09-03 16:45:14,680 - __main__ - INFO - OOS DAPY(hits): 40.29 | OOS IR: 0.17 | OOS hit-rate: 0.580
2025-09-03 16:45:14,696 - __main__ - INFO - Calculating comprehensive performance metrics...
2025-09-03 16:45:14,698 - metrics.performance_report - INFO - Performance summary saved to artifacts/performance_summary.csv
2025-09-03 16:45:14,703 - diagnostics.diagnostic_output - INFO - \U0001f4be Saved comprehensive diagnostics to artifacts/diagnostics/diagnostic_ESC_20250903_164514.json
2025-09-03 16:45:14,703 - diagnostics.diagnostic_output - INFO - \U0001f4c4 Saved diagnostic summary to artifacts/diagnostics/summary_ESC_20250903_164514.txt
2025-09-03 16:45:14,705 - __main__ - INFO - \u2705 Completed @ES#C
2025-09-03 16:45:14,705 - __main__ - INFO - 
================================================================================
2025-09-03 16:45:14,705 - __main__ - INFO - \U0001f4ca FINAL SUMMARY: 1/1 targets completed successfully
2025-09-03 16:45:14,705 - __main__ - INFO - ================================================================================
GPU acceleration enabled for XGBoost
OOS Shuffling p-value (DAPY): 0.0049751244 (obs=40.29)

==================================================
            OUT-OF-SAMPLE PERFORMANCE             
==================================================

RETURNS:
  Total Return:           5.85%
  Annualized Return:      1.40%
  Volatility:             8.34%
  Sharpe Ratio:            0.17

RISK:
  Max Drawdown:         -15.68%

ACCURACY:
  Win Rate:              48.25%
  Hit Rate:              48.25%
  Avg Win:               0.0033
  Avg Loss:             -0.0033

TRADES:
  Total Trades:            1057
  Winning Trades:           510
  Losing Trades:            489
==================================================
