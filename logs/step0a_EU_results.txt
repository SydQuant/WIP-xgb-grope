2025-09-03 16:13:34,780 - __main__ - INFO - \U0001f4c4 Loaded configuration from configs/individual_target_test.yaml
2025-09-03 16:13:34,781 - __main__ - INFO - \U0001f4c4 Using configuration: configs/individual_target_test.yaml
2025-09-03 16:13:34,781 - __main__ - INFO - \U0001f680 Starting XGB Ensemble Analysis
2025-09-03 16:13:34,781 - __main__ - INFO - \U0001f3af Target symbols: ['@EU#C']
2025-09-03 16:13:34,781 - __main__ - INFO - 
================================================================================
2025-09-03 16:13:34,781 - __main__ - INFO - \U0001f504 PROCESSING TARGET 1/1: @EU#C
2025-09-03 16:13:34,781 - __main__ - INFO - ================================================================================
2025-09-03 16:13:34,781 - __main__ - INFO - \U0001f504 Loading real market data for target: @EU#C
2025-09-03 16:13:34,781 - data.data_utils_simple - INFO - Preparing data for @EU#C, period 2020-07-01 to 2024-08-01
2025-09-03 16:13:34,957 - data.data_utils_simple - INFO - Loaded data for 10 symbols
C:\Users\zhang\Desktop\Steve\bond_ls_xgb_grope_full_v6\data\data_utils_simple.py:279: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  df[target_col] = target_returns.reindex(df.index)
2025-09-03 16:13:35,646 - data.data_utils_simple - INFO - Cleaning data: (1057, 523)
2025-09-03 16:13:35,806 - data.data_utils_simple - INFO - Cleaned data: (1057, 523) (dropped 0 features)
2025-09-03 16:13:35,809 - data.data_utils_simple - INFO - Final dataset: (1057, 523), target mean=-0.000115, target std=0.004623
2025-09-03 16:13:35,818 - __main__ - INFO - \u2705 Loaded data: X shape (1057, 522), y shape (1057,)
2025-09-03 16:13:35,818 - __main__ - INFO - \U0001f4c5 Date range: 2020-07-01 12:00:00 to 2024-07-31 12:00:00
2025-09-03 16:13:35,818 - __main__ - INFO - Loaded real data: X shape (1057, 522), y shape (1057,)
2025-09-03 16:13:35,818 - __main__ - INFO - Date range: 2020-07-01 12:00:00 to 2024-07-31 12:00:00
2025-09-03 16:13:35,818 - __main__ - INFO - Applying smart block-wise feature selection: 522 -> 50 features
2025-09-03 16:13:35,818 - model.feature_selection - INFO - Smart block-wise selection: 522 -> blocks of 100 -> local clustering -> global deduplication
2025-09-03 16:13:35,818 - model.feature_selection - INFO - Processing block 1/6: 100 features
2025-09-03 16:13:35,871 - model.feature_selection - INFO - Block 1: Selected 15 features (best: 0.1072)
2025-09-03 16:13:35,872 - model.feature_selection - INFO - Processing block 2/6: 100 features
2025-09-03 16:13:35,889 - model.feature_selection - INFO - Block 2: Selected 15 features (best: 0.0925)
2025-09-03 16:13:35,889 - model.feature_selection - INFO - Processing block 3/6: 100 features
2025-09-03 16:13:35,912 - model.feature_selection - INFO - Block 3: Selected 15 features (best: 0.1050)
2025-09-03 16:13:35,912 - model.feature_selection - INFO - Processing block 4/6: 100 features
2025-09-03 16:13:35,973 - model.feature_selection - INFO - Block 4: Selected 15 features (best: 0.1167)
2025-09-03 16:13:35,973 - model.feature_selection - INFO - Processing block 5/6: 100 features
2025-09-03 16:13:36,009 - model.feature_selection - INFO - Block 5: Selected 15 features (best: 0.0859)
2025-09-03 16:13:36,009 - model.feature_selection - INFO - Processing block 6/6: 22 features
2025-09-03 16:13:36,026 - model.feature_selection - INFO - Block 6: Selected 8 features (best: 0.0779)
2025-09-03 16:13:36,026 - model.feature_selection - INFO - Global deduplication: 83 candidates -> removing cross-block correlations
2025-09-03 16:13:36,106 - model.feature_selection - INFO - \u2705 Smart block-wise selection complete: 50 features selected
2025-09-03 16:13:36,106 - model.feature_selection - INFO -    Approximates clustering with corr_threshold=0.7
2025-09-03 16:13:36,107 - __main__ - INFO - Feature selection complete: (1057, 50)
2025-09-03 16:13:36,372 - __main__ - INFO - [Fold 0] Training data: X_tr(252, 50), y_tr(252,)
2025-09-03 16:13:36,372 - __main__ - INFO - [Fold 0] Target stats: mean=0.000149, std=0.003674
2025-09-03 16:13:36,374 - __main__ - INFO - [Fold 0] Feature stats: 404.750026 total magnitude
C:\Users\zhang\anaconda3\Lib\site-packages\xgboost\core.py:729: UserWarning: [16:13:36] WARNING: C:\actions-runner\_work\xgboost\xgboost\src\common\error_msg.cc:58: Falling back to prediction using DMatrix due to mismatched devices. This might lead to higher memory usage and slower performance. XGBoost is running on: cuda:0, while the input data is on: cpu.
Potential solutions:
- Use a data structure that matches the device ordinal in the booster.
- Set the device for booster before call to inplace_predict.

This warning will only be shown once.

  return func(**kwargs)
2025-09-03 16:13:56,267 - __main__ - INFO - Fold 0 XGBoost predictions: train_preds count=50, test_preds count=50
2025-09-03 16:13:56,267 - __main__ - INFO - Fold 0 test prediction stats: model_0: mean=0.000141, std=0.002984, range=[-0.008599, 0.006700]; model_1: mean=0.000189, std=0.003428, range=[-0.011074, 0.008266]; model_2: mean=0.000220, std=0.002495, range=[-0.006211, 0.005024]
2025-09-03 16:14:02,526 - __main__ - INFO - Fold 0: Selected 12 models, weights: ['0.383', '0.028', '0.110', '0.008', '0.020', '0.007', '0.090', '0.007', '0.262', '0.005', '0.072', '0.008'], tau: 0.914
2025-09-03 16:14:02,526 - __main__ - INFO - Fold 0 individual test signals: count=12, lengths=[176, 176, 176], magnitudes=[91.93669217449245, 89.94231649159399, 92.2500624768077]
2025-09-03 16:14:02,527 - __main__ - INFO - Fold 0 signal stats: mean=-0.036625, std=0.603485, sum=-6.446040, magnitude=90.634364
2025-09-03 16:14:02,528 - __main__ - INFO - [Fold 1] Training data: X_tr(252, 50), y_tr(252,)
2025-09-03 16:14:02,528 - __main__ - INFO - [Fold 1] Target stats: mean=0.000149, std=0.003674
2025-09-03 16:14:02,529 - __main__ - INFO - [Fold 1] Feature stats: 404.750026 total magnitude
2025-09-03 16:14:30,828 - __main__ - INFO - Fold 1 XGBoost predictions: train_preds count=50, test_preds count=50
2025-09-03 16:14:30,829 - __main__ - INFO - Fold 1 test prediction stats: model_0: mean=0.000191, std=0.002318, range=[-0.010518, 0.005473]; model_1: mean=0.000034, std=0.002886, range=[-0.015902, 0.007686]; model_2: mean=0.000157, std=0.001904, range=[-0.009509, 0.004905]
2025-09-03 16:14:37,251 - __main__ - INFO - Fold 1: Selected 12 models, weights: ['0.079', '0.121', '0.077', '0.008', '0.006', '0.004', '0.058', '0.229', '0.177', '0.008', '0.004', '0.229'], tau: 0.983
2025-09-03 16:14:37,251 - __main__ - INFO - Fold 1 individual test signals: count=12, lengths=[176, 176, 176], magnitudes=[80.22016717705043, 80.31111934673666, 74.20975029260283]
2025-09-03 16:14:37,253 - __main__ - INFO - Fold 1 signal stats: mean=0.060887, std=0.471561, sum=10.716181, magnitude=66.964427
2025-09-03 16:14:37,254 - __main__ - INFO - [Fold 2] Training data: X_tr(352, 50), y_tr(352,)
2025-09-03 16:14:37,254 - __main__ - INFO - [Fold 2] Target stats: mean=0.000019, std=0.003443
2025-09-03 16:14:37,255 - __main__ - INFO - [Fold 2] Feature stats: 407.730233 total magnitude
2025-09-03 16:15:08,840 - __main__ - INFO - Fold 2 XGBoost predictions: train_preds count=50, test_preds count=50
2025-09-03 16:15:08,840 - __main__ - INFO - Fold 2 test prediction stats: model_0: mean=-0.000367, std=0.001493, range=[-0.004155, 0.003453]; model_1: mean=-0.000991, std=0.002016, range=[-0.009502, 0.003699]; model_2: mean=-0.000472, std=0.001382, range=[-0.004459, 0.003685]
2025-09-03 16:15:15,398 - __main__ - INFO - Fold 2: Selected 12 models, weights: ['0.000', '0.099', '0.000', '0.224', '0.224', '0.000', '0.000', '0.224', '0.224', '0.000', '0.000', '0.003'], tau: 0.243
2025-09-03 16:15:15,399 - __main__ - INFO - Fold 2 individual test signals: count=12, lengths=[176, 176, 176], magnitudes=[95.56246950911535, 96.86351566643305, 90.52848470419013]
2025-09-03 16:15:15,403 - __main__ - INFO - Fold 2 signal stats: mean=-0.016647, std=0.482391, sum=-2.929868, magnitude=69.550553
2025-09-03 16:15:15,403 - __main__ - INFO - [Fold 3] Training data: X_tr(528, 50), y_tr(528,)
2025-09-03 16:15:15,403 - __main__ - INFO - [Fold 3] Target stats: mean=-0.000277, std=0.004259
2025-09-03 16:15:15,406 - __main__ - INFO - [Fold 3] Feature stats: 401.831492 total magnitude
2025-09-03 16:15:51,635 - __main__ - INFO - Fold 3 XGBoost predictions: train_preds count=50, test_preds count=50
2025-09-03 16:15:51,635 - __main__ - INFO - Fold 3 test prediction stats: model_0: mean=-0.000543, std=0.002134, range=[-0.006630, 0.004952]; model_1: mean=-0.000811, std=0.002684, range=[-0.009453, 0.009657]; model_2: mean=-0.000468, std=0.002244, range=[-0.006484, 0.006441]
2025-09-03 16:15:58,781 - __main__ - INFO - Fold 3: Selected 12 models, weights: ['0.001', '0.010', '0.001', '0.001', '0.001', '0.629', '0.296', '0.001', '0.001', '0.029', '0.027', '0.004'], tau: 0.592
2025-09-03 16:15:58,781 - __main__ - INFO - Fold 3 individual test signals: count=12, lengths=[176, 176, 176], magnitudes=[95.59803941448314, 94.60743322934556, 89.9768913350319]
2025-09-03 16:15:58,782 - __main__ - INFO - Fold 3 signal stats: mean=-0.032743, std=0.515913, sum=-5.762704, magnitude=77.563031
2025-09-03 16:15:58,783 - __main__ - INFO - [Fold 4] Training data: X_tr(704, 50), y_tr(704,)
2025-09-03 16:15:58,783 - __main__ - INFO - [Fold 4] Target stats: mean=-0.000164, std=0.004850
2025-09-03 16:15:58,783 - __main__ - INFO - [Fold 4] Feature stats: 401.700179 total magnitude
2025-09-03 16:16:37,311 - __main__ - INFO - Fold 4 XGBoost predictions: train_preds count=50, test_preds count=50
2025-09-03 16:16:37,311 - __main__ - INFO - Fold 4 test prediction stats: model_0: mean=-0.000429, std=0.002429, range=[-0.008965, 0.007838]; model_1: mean=-0.000733, std=0.002324, range=[-0.006365, 0.007141]; model_2: mean=-0.000495, std=0.002127, range=[-0.004901, 0.009011]
2025-09-03 16:16:44,855 - __main__ - INFO - Fold 4: Selected 12 models, weights: ['0.185', '0.563', '0.004', '0.002', '0.177', '0.001', '0.032', '0.000', '0.000', '0.037', '0.000', '0.000'], tau: 0.200
2025-09-03 16:16:44,855 - __main__ - INFO - Fold 4 individual test signals: count=12, lengths=[176, 176, 176], magnitudes=[90.55036593663374, 89.76164309724612, 90.81839725347203]
2025-09-03 16:16:44,857 - __main__ - INFO - Fold 4 signal stats: mean=0.049190, std=0.477153, sum=8.657392, magnitude=69.673485
2025-09-03 16:16:44,858 - __main__ - INFO - [Fold 5] Training data: X_tr(880, 50), y_tr(880,)
2025-09-03 16:16:44,858 - __main__ - INFO - [Fold 5] Target stats: mean=-0.000122, std=0.004803
2025-09-03 16:16:44,859 - __main__ - INFO - [Fold 5] Feature stats: 400.439780 total magnitude
2025-09-03 16:17:15,657 - __main__ - INFO - Fold 5 XGBoost predictions: train_preds count=50, test_preds count=50
2025-09-03 16:17:15,657 - __main__ - INFO - Fold 5 test prediction stats: model_0: mean=-0.000072, std=0.002201, range=[-0.006401, 0.005341]; model_1: mean=-0.000069, std=0.002619, range=[-0.006821, 0.008944]; model_2: mean=0.000038, std=0.002140, range=[-0.006045, 0.005908]
2025-09-03 16:17:23,805 - __main__ - INFO - Fold 5: Selected 12 models, weights: ['0.006', '0.206', '0.024', '0.206', '0.009', '0.206', '0.066', '0.206', '0.006', '0.025', '0.033', '0.006'], tau: 1.105
2025-09-03 16:17:23,805 - __main__ - INFO - Fold 5 individual test signals: count=12, lengths=[177, 177, 177], magnitudes=[93.79606362909283, 88.7153404026837, 92.43437362735224]
2025-09-03 16:17:23,806 - __main__ - INFO - Fold 5 signal stats: mean=-0.062734, std=0.464529, sum=-11.104000, magnitude=67.818574
2025-09-03 16:17:23,806 - __main__ - INFO - \U0001f4cb Processing complete: 6 fold summaries created
2025-09-03 16:17:23,806 - __main__ - INFO - \U0001f4ca OOS signal magnitude: 442.2044347761
2025-09-03 16:17:23,807 - __main__ - INFO - OOS DAPY(hits): 53.64 | OOS IR: 0.37 | OOS hit-rate: 0.606
2025-09-03 16:17:23,825 - __main__ - INFO - Calculating comprehensive performance metrics...
2025-09-03 16:17:23,826 - __main__ - ERROR - \u274c Error processing @EU#C: 'gbk' codec can't encode character '\U0001f4c8' in position 160: illegal multibyte sequence
2025-09-03 16:17:23,828 - __main__ - INFO - 
================================================================================
2025-09-03 16:17:23,828 - __main__ - INFO - \U0001f4ca FINAL SUMMARY: 0/1 targets completed successfully
2025-09-03 16:17:23,828 - __main__ - INFO - ================================================================================
GPU acceleration enabled for XGBoost
OOS Shuffling p-value (DAPY): 0.0049751244 (obs=53.64)
