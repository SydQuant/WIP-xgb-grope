2025-09-03 16:13:43,793 - __main__ - INFO - \U0001f4c4 Loaded configuration from configs/individual_target_test.yaml
2025-09-03 16:13:43,793 - __main__ - INFO - \U0001f4c4 Using configuration: configs/individual_target_test.yaml
2025-09-03 16:13:43,793 - __main__ - INFO - \U0001f680 Starting XGB Ensemble Analysis
2025-09-03 16:13:43,793 - __main__ - INFO - \U0001f3af Target symbols: ['QGC#C']
2025-09-03 16:13:43,793 - __main__ - INFO - 
================================================================================
2025-09-03 16:13:43,793 - __main__ - INFO - \U0001f504 PROCESSING TARGET 1/1: QGC#C
2025-09-03 16:13:43,793 - __main__ - INFO - ================================================================================
2025-09-03 16:13:43,793 - __main__ - INFO - \U0001f504 Loading real market data for target: QGC#C
2025-09-03 16:13:43,794 - data.data_utils_simple - INFO - Preparing data for QGC#C, period 2020-07-01 to 2024-08-01
2025-09-03 16:13:43,994 - data.data_utils_simple - INFO - Loaded data for 10 symbols
C:\Users\zhang\Desktop\Steve\bond_ls_xgb_grope_full_v6\data\data_utils_simple.py:279: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  df[target_col] = target_returns.reindex(df.index)
2025-09-03 16:13:44,698 - data.data_utils_simple - INFO - Cleaning data: (1057, 523)
2025-09-03 16:13:44,859 - data.data_utils_simple - INFO - Cleaned data: (1057, 523) (dropped 0 features)
2025-09-03 16:13:44,862 - data.data_utils_simple - INFO - Final dataset: (1057, 523), target mean=0.000129, target std=0.008221
2025-09-03 16:13:44,870 - __main__ - INFO - \u2705 Loaded data: X shape (1057, 522), y shape (1057,)
2025-09-03 16:13:44,870 - __main__ - INFO - \U0001f4c5 Date range: 2020-07-01 12:00:00 to 2024-07-31 12:00:00
2025-09-03 16:13:44,870 - __main__ - INFO - Loaded real data: X shape (1057, 522), y shape (1057,)
2025-09-03 16:13:44,870 - __main__ - INFO - Date range: 2020-07-01 12:00:00 to 2024-07-31 12:00:00
2025-09-03 16:13:44,870 - __main__ - INFO - Applying smart block-wise feature selection: 522 -> 50 features
2025-09-03 16:13:44,870 - model.feature_selection - INFO - Smart block-wise selection: 522 -> blocks of 100 -> local clustering -> global deduplication
2025-09-03 16:13:44,870 - model.feature_selection - INFO - Processing block 1/6: 100 features
2025-09-03 16:13:44,913 - model.feature_selection - INFO - Block 1: Selected 15 features (best: 0.0805)
2025-09-03 16:13:44,913 - model.feature_selection - INFO - Processing block 2/6: 100 features
2025-09-03 16:13:44,941 - model.feature_selection - INFO - Block 2: Selected 15 features (best: 0.0703)
2025-09-03 16:13:44,941 - model.feature_selection - INFO - Processing block 3/6: 100 features
2025-09-03 16:13:44,968 - model.feature_selection - INFO - Block 3: Selected 15 features (best: 0.0567)
2025-09-03 16:13:44,968 - model.feature_selection - INFO - Processing block 4/6: 100 features
2025-09-03 16:13:45,025 - model.feature_selection - INFO - Block 4: Selected 15 features (best: 0.0736)
2025-09-03 16:13:45,025 - model.feature_selection - INFO - Processing block 5/6: 100 features
2025-09-03 16:13:45,042 - model.feature_selection - INFO - Block 5: Selected 15 features (best: 0.1201)
2025-09-03 16:13:45,042 - model.feature_selection - INFO - Processing block 6/6: 22 features
2025-09-03 16:13:45,048 - model.feature_selection - INFO - Block 6: Selected 8 features (best: 0.0635)
2025-09-03 16:13:45,048 - model.feature_selection - INFO - Global deduplication: 83 candidates -> removing cross-block correlations
2025-09-03 16:13:45,133 - model.feature_selection - INFO - \u2705 Smart block-wise selection complete: 50 features selected
2025-09-03 16:13:45,133 - model.feature_selection - INFO -    Approximates clustering with corr_threshold=0.7
2025-09-03 16:13:45,133 - __main__ - INFO - Feature selection complete: (1057, 50)
2025-09-03 16:13:45,413 - __main__ - INFO - [Fold 0] Training data: X_tr(252, 50), y_tr(252,)
2025-09-03 16:13:45,413 - __main__ - INFO - [Fold 0] Target stats: mean=-0.000175, std=0.009137
2025-09-03 16:13:45,415 - __main__ - INFO - [Fold 0] Feature stats: 308.239413 total magnitude
C:\Users\zhang\anaconda3\Lib\site-packages\xgboost\core.py:729: UserWarning: [16:13:46] WARNING: C:\actions-runner\_work\xgboost\xgboost\src\common\error_msg.cc:58: Falling back to prediction using DMatrix due to mismatched devices. This might lead to higher memory usage and slower performance. XGBoost is running on: cuda:0, while the input data is on: cpu.
Potential solutions:
- Use a data structure that matches the device ordinal in the booster.
- Set the device for booster before call to inplace_predict.

This warning will only be shown once.

  return func(**kwargs)
2025-09-03 16:14:20,841 - __main__ - INFO - Fold 0 XGBoost predictions: train_preds count=50, test_preds count=50
2025-09-03 16:14:20,841 - __main__ - INFO - Fold 0 test prediction stats: model_0: mean=-0.000482, std=0.008931, range=[-0.037634, 0.019234]; model_1: mean=-0.000505, std=0.009472, range=[-0.039133, 0.020203]; model_2: mean=-0.000458, std=0.008303, range=[-0.036019, 0.018655]
2025-09-03 16:14:27,194 - __main__ - INFO - Fold 0: Selected 12 models, weights: ['0.062', '0.000', '0.017', '0.051', '0.000', '0.004', '0.000', '0.301', '0.000', '0.000', '0.339', '0.225'], tau: 0.311
2025-09-03 16:14:27,194 - __main__ - INFO - Fold 0 individual test signals: count=12, lengths=[176, 176, 176], magnitudes=[84.77444699904581, 83.81978725524452, 83.87997738511088]
2025-09-03 16:14:27,195 - __main__ - INFO - Fold 0 signal stats: mean=-0.032023, std=0.571361, sum=-5.635976, magnitude=83.168696
2025-09-03 16:14:27,196 - __main__ - INFO - [Fold 1] Training data: X_tr(252, 50), y_tr(252,)
2025-09-03 16:14:27,196 - __main__ - INFO - [Fold 1] Target stats: mean=-0.000175, std=0.009137
2025-09-03 16:14:27,196 - __main__ - INFO - [Fold 1] Feature stats: 308.239413 total magnitude
2025-09-03 16:15:03,753 - __main__ - INFO - Fold 1 XGBoost predictions: train_preds count=50, test_preds count=50
2025-09-03 16:15:03,753 - __main__ - INFO - Fold 1 test prediction stats: model_0: mean=-0.000018, std=0.005716, range=[-0.038140, 0.018127]; model_1: mean=0.000039, std=0.006600, range=[-0.040150, 0.018272]; model_2: mean=0.000326, std=0.005907, range=[-0.038067, 0.017060]
2025-09-03 16:15:10,291 - __main__ - INFO - Fold 1: Selected 12 models, weights: ['0.149', '0.144', '0.081', '0.018', '0.033', '0.114', '0.018', '0.135', '0.018', '0.061', '0.151', '0.076'], tau: 1.906
2025-09-03 16:15:10,291 - __main__ - INFO - Fold 1 individual test signals: count=12, lengths=[176, 176, 176], magnitudes=[81.36689615005463, 82.91886255296619, 76.15193373622864]
2025-09-03 16:15:10,292 - __main__ - INFO - Fold 1 signal stats: mean=-0.024649, std=0.476571, sum=-4.338297, magnitude=66.965988
2025-09-03 16:15:10,293 - __main__ - INFO - [Fold 2] Training data: X_tr(352, 50), y_tr(352,)
2025-09-03 16:15:10,293 - __main__ - INFO - [Fold 2] Target stats: mean=-0.000060, std=0.008526
2025-09-03 16:15:10,295 - __main__ - INFO - [Fold 2] Feature stats: 308.929378 total magnitude
2025-09-03 16:15:48,379 - __main__ - INFO - Fold 2 XGBoost predictions: train_preds count=50, test_preds count=50
2025-09-03 16:15:48,379 - __main__ - INFO - Fold 2 test prediction stats: model_0: mean=-0.000298, std=0.004548, range=[-0.018180, 0.009979]; model_1: mean=-0.000987, std=0.005006, range=[-0.016086, 0.008679]; model_2: mean=-0.000586, std=0.004337, range=[-0.017714, 0.009996]
2025-09-03 16:15:55,017 - __main__ - INFO - Fold 2: Selected 12 models, weights: ['0.123', '0.031', '0.128', '0.118', '0.135', '0.068', '0.106', '0.032', '0.032', '0.060', '0.135', '0.031'], tau: 2.723
2025-09-03 16:15:55,017 - __main__ - INFO - Fold 2 individual test signals: count=12, lengths=[176, 176, 176], magnitudes=[93.20388750461714, 94.56265554081006, 93.04282769683446]
2025-09-03 16:15:55,018 - __main__ - INFO - Fold 2 signal stats: mean=0.001967, std=0.480906, sum=0.346255, magnitude=70.116363
2025-09-03 16:15:55,019 - __main__ - INFO - [Fold 3] Training data: X_tr(528, 50), y_tr(528,)
2025-09-03 16:15:55,019 - __main__ - INFO - [Fold 3] Target stats: mean=-0.000234, std=0.008442
2025-09-03 16:15:55,020 - __main__ - INFO - [Fold 3] Feature stats: 308.219872 total magnitude
2025-09-03 16:16:35,736 - __main__ - INFO - Fold 3 XGBoost predictions: train_preds count=50, test_preds count=50
2025-09-03 16:16:35,737 - __main__ - INFO - Fold 3 test prediction stats: model_0: mean=-0.000538, std=0.004236, range=[-0.014302, 0.010629]; model_1: mean=-0.000572, std=0.004188, range=[-0.013196, 0.010674]; model_2: mean=0.000583, std=0.003542, range=[-0.007369, 0.009432]
2025-09-03 16:16:42,896 - __main__ - INFO - Fold 3: Selected 12 models, weights: ['0.012', '0.004', '0.117', '0.086', '0.230', '0.090', '0.008', '0.017', '0.079', '0.294', '0.012', '0.052'], tau: 0.921
2025-09-03 16:16:42,896 - __main__ - INFO - Fold 3 individual test signals: count=12, lengths=[176, 176, 176], magnitudes=[90.67840767655278, 89.30916852214227, 97.17322312346192]
2025-09-03 16:16:42,897 - __main__ - INFO - Fold 3 signal stats: mean=-0.000245, std=0.439594, sum=-0.043067, magnitude=62.744197
2025-09-03 16:16:42,898 - __main__ - INFO - [Fold 4] Training data: X_tr(704, 50), y_tr(704,)
2025-09-03 16:16:42,898 - __main__ - INFO - [Fold 4] Target stats: mean=-0.000065, std=0.008386
2025-09-03 16:16:42,900 - __main__ - INFO - [Fold 4] Feature stats: 307.024823 total magnitude
2025-09-03 16:17:16,241 - __main__ - INFO - Fold 4 XGBoost predictions: train_preds count=50, test_preds count=50
2025-09-03 16:17:16,242 - __main__ - INFO - Fold 4 test prediction stats: model_0: mean=0.000698, std=0.004424, range=[-0.014381, 0.013918]; model_1: mean=0.000092, std=0.004895, range=[-0.016583, 0.012521]; model_2: mean=0.000048, std=0.004313, range=[-0.017839, 0.008820]
2025-09-03 16:17:24,003 - __main__ - INFO - Fold 4: Selected 12 models, weights: ['0.919', '0.001', '0.000', '0.001', '0.000', '0.000', '0.000', '0.000', '0.002', '0.011', '0.065', '0.000'], tau: 0.399
2025-09-03 16:17:24,003 - __main__ - INFO - Fold 4 individual test signals: count=12, lengths=[176, 176, 176], magnitudes=[90.78188356502639, 96.20156022476885, 88.99417273937854]
2025-09-03 16:17:24,004 - __main__ - INFO - Fold 4 signal stats: mean=0.067606, std=0.573055, sum=11.898692, magnitude=86.967107
2025-09-03 16:17:24,006 - __main__ - INFO - [Fold 5] Training data: X_tr(880, 50), y_tr(880,)
2025-09-03 16:17:24,006 - __main__ - INFO - [Fold 5] Target stats: mean=-0.000067, std=0.008095
2025-09-03 16:17:24,007 - __main__ - INFO - [Fold 5] Feature stats: 306.123958 total magnitude
2025-09-03 16:17:38,523 - __main__ - INFO - Fold 5 XGBoost predictions: train_preds count=50, test_preds count=50
2025-09-03 16:17:38,523 - __main__ - INFO - Fold 5 test prediction stats: model_0: mean=0.000300, std=0.004013, range=[-0.010487, 0.012199]; model_1: mean=-0.000108, std=0.004286, range=[-0.011422, 0.011767]; model_2: mean=-0.000165, std=0.004072, range=[-0.009131, 0.015975]
2025-09-03 16:17:44,687 - __main__ - INFO - Fold 5: Selected 12 models, weights: ['0.143', '0.146', '0.002', '0.002', '0.002', '0.184', '0.040', '0.184', '0.002', '0.002', '0.172', '0.119'], tau: 0.852
2025-09-03 16:17:44,687 - __main__ - INFO - Fold 5 individual test signals: count=12, lengths=[177, 177, 177], magnitudes=[88.85289996835725, 91.08282097167992, 95.22074021513313]
2025-09-03 16:17:44,688 - __main__ - INFO - Fold 5 signal stats: mean=0.047541, std=0.408027, sum=8.414723, magnitude=57.629316
2025-09-03 16:17:44,688 - __main__ - INFO - \U0001f4cb Processing complete: 6 fold summaries created
2025-09-03 16:17:44,688 - __main__ - INFO - \U0001f4ca OOS signal magnitude: 427.5916664305
2025-09-03 16:17:44,688 - __main__ - INFO - OOS DAPY(hits): 48.40 | OOS IR: -0.34 | OOS hit-rate: 0.596
2025-09-03 16:17:44,704 - __main__ - INFO - Calculating comprehensive performance metrics...
2025-09-03 16:17:44,705 - __main__ - ERROR - \u274c Error processing QGC#C: 'gbk' codec can't encode character '\U0001f4c8' in position 160: illegal multibyte sequence
2025-09-03 16:17:44,707 - __main__ - INFO - 
================================================================================
2025-09-03 16:17:44,707 - __main__ - INFO - \U0001f4ca FINAL SUMMARY: 0/1 targets completed successfully
2025-09-03 16:17:44,707 - __main__ - INFO - ================================================================================
GPU acceleration enabled for XGBoost
OOS Shuffling p-value (DAPY): 0.0049751244 (obs=48.40)
