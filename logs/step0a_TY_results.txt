2025-09-03 16:13:28,543 - __main__ - INFO - \U0001f4c4 Loaded configuration from configs/individual_target_test.yaml
2025-09-03 16:13:28,543 - __main__ - INFO - \U0001f4c4 Using configuration: configs/individual_target_test.yaml
2025-09-03 16:13:28,543 - __main__ - INFO - \U0001f680 Starting XGB Ensemble Analysis
2025-09-03 16:13:28,543 - __main__ - INFO - \U0001f3af Target symbols: ['@TY#C']
2025-09-03 16:13:28,543 - __main__ - INFO - 
================================================================================
2025-09-03 16:13:28,543 - __main__ - INFO - \U0001f504 PROCESSING TARGET 1/1: @TY#C
2025-09-03 16:13:28,543 - __main__ - INFO - ================================================================================
2025-09-03 16:13:28,543 - __main__ - INFO - \U0001f504 Loading real market data for target: @TY#C
2025-09-03 16:13:28,543 - data.data_utils_simple - INFO - Preparing data for @TY#C, period 2020-07-01 to 2024-08-01
2025-09-03 16:13:28,664 - data.data_utils_simple - INFO - Loaded data for 10 symbols
C:\Users\zhang\Desktop\Steve\bond_ls_xgb_grope_full_v6\data\data_utils_simple.py:279: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  df[target_col] = target_returns.reindex(df.index)
2025-09-03 16:13:29,166 - data.data_utils_simple - INFO - Cleaning data: (1057, 523)
2025-09-03 16:13:29,283 - data.data_utils_simple - INFO - Cleaned data: (1057, 523) (dropped 0 features)
2025-09-03 16:13:29,285 - data.data_utils_simple - INFO - Final dataset: (1057, 523), target mean=-0.000249, target std=0.003829
2025-09-03 16:13:29,293 - __main__ - INFO - \u2705 Loaded data: X shape (1057, 522), y shape (1057,)
2025-09-03 16:13:29,293 - __main__ - INFO - \U0001f4c5 Date range: 2020-07-01 12:00:00 to 2024-07-31 12:00:00
2025-09-03 16:13:29,293 - __main__ - INFO - Loaded real data: X shape (1057, 522), y shape (1057,)
2025-09-03 16:13:29,293 - __main__ - INFO - Date range: 2020-07-01 12:00:00 to 2024-07-31 12:00:00
2025-09-03 16:13:29,293 - __main__ - INFO - Applying smart block-wise feature selection: 522 -> 50 features
2025-09-03 16:13:29,293 - model.feature_selection - INFO - Smart block-wise selection: 522 -> blocks of 100 -> local clustering -> global deduplication
2025-09-03 16:13:29,293 - model.feature_selection - INFO - Processing block 1/6: 100 features
2025-09-03 16:13:29,319 - model.feature_selection - INFO - Block 1: Selected 15 features (best: 0.0751)
2025-09-03 16:13:29,320 - model.feature_selection - INFO - Processing block 2/6: 100 features
2025-09-03 16:13:29,333 - model.feature_selection - INFO - Block 2: Selected 15 features (best: 0.0696)
2025-09-03 16:13:29,333 - model.feature_selection - INFO - Processing block 3/6: 100 features
2025-09-03 16:13:29,346 - model.feature_selection - INFO - Block 3: Selected 15 features (best: 0.0697)
2025-09-03 16:13:29,346 - model.feature_selection - INFO - Processing block 4/6: 100 features
2025-09-03 16:13:29,392 - model.feature_selection - INFO - Block 4: Selected 15 features (best: 0.0798)
2025-09-03 16:13:29,392 - model.feature_selection - INFO - Processing block 5/6: 100 features
2025-09-03 16:13:29,406 - model.feature_selection - INFO - Block 5: Selected 15 features (best: 0.0732)
2025-09-03 16:13:29,406 - model.feature_selection - INFO - Processing block 6/6: 22 features
2025-09-03 16:13:29,410 - model.feature_selection - INFO - Block 6: Selected 9 features (best: 0.0684)
2025-09-03 16:13:29,410 - model.feature_selection - INFO - Global deduplication: 84 candidates -> removing cross-block correlations
2025-09-03 16:13:29,490 - model.feature_selection - INFO - \u2705 Smart block-wise selection complete: 50 features selected
2025-09-03 16:13:29,490 - model.feature_selection - INFO -    Approximates clustering with corr_threshold=0.7
2025-09-03 16:13:29,490 - __main__ - INFO - Feature selection complete: (1057, 50)
2025-09-03 16:13:29,703 - __main__ - INFO - [Fold 0] Training data: X_tr(252, 50), y_tr(252,)
2025-09-03 16:13:29,703 - __main__ - INFO - [Fold 0] Target stats: mean=-0.000172, std=0.002027
2025-09-03 16:13:29,705 - __main__ - INFO - [Fold 0] Feature stats: 227.633216 total magnitude
C:\Users\zhang\anaconda3\Lib\site-packages\xgboost\core.py:729: UserWarning: [16:13:29] WARNING: C:\actions-runner\_work\xgboost\xgboost\src\common\error_msg.cc:58: Falling back to prediction using DMatrix due to mismatched devices. This might lead to higher memory usage and slower performance. XGBoost is running on: cuda:0, while the input data is on: cpu.
Potential solutions:
- Use a data structure that matches the device ordinal in the booster.
- Set the device for booster before call to inplace_predict.

This warning will only be shown once.

  return func(**kwargs)
2025-09-03 16:13:37,876 - __main__ - INFO - Fold 0 XGBoost predictions: train_preds count=50, test_preds count=50
2025-09-03 16:13:37,877 - __main__ - INFO - Fold 0 test prediction stats: model_0: mean=-0.000235, std=0.001263, range=[-0.005263, 0.003473]; model_1: mean=-0.000262, std=0.001824, range=[-0.008114, 0.006146]; model_2: mean=-0.000231, std=0.000916, range=[-0.003555, 0.001808]
2025-09-03 16:13:44,434 - __main__ - INFO - Fold 0: Selected 12 models, weights: ['0.150', '0.068', '0.109', '0.150', '0.030', '0.150', '0.009', '0.128', '0.029', '0.038', '0.004', '0.133'], tau: 1.140
2025-09-03 16:13:44,434 - __main__ - INFO - Fold 0 individual test signals: count=12, lengths=[176, 176, 176], magnitudes=[93.90776351672596, 95.62592587733968, 94.70986071811151]
2025-09-03 16:13:44,436 - __main__ - INFO - Fold 0 signal stats: mean=-0.076253, std=0.614661, sum=-13.420579, magnitude=94.697676
2025-09-03 16:13:44,436 - __main__ - INFO - [Fold 1] Training data: X_tr(252, 50), y_tr(252,)
2025-09-03 16:13:44,436 - __main__ - INFO - [Fold 1] Target stats: mean=-0.000172, std=0.002027
2025-09-03 16:13:44,437 - __main__ - INFO - [Fold 1] Feature stats: 227.633216 total magnitude
2025-09-03 16:14:13,338 - __main__ - INFO - Fold 1 XGBoost predictions: train_preds count=50, test_preds count=50
2025-09-03 16:14:13,338 - __main__ - INFO - Fold 1 test prediction stats: model_0: mean=-0.000075, std=0.001016, range=[-0.004186, 0.003005]; model_1: mean=0.000051, std=0.001427, range=[-0.005212, 0.004993]; model_2: mean=0.000041, std=0.000714, range=[-0.002932, 0.001776]
2025-09-03 16:14:19,833 - __main__ - INFO - Fold 1: Selected 12 models, weights: ['0.028', '0.028', '0.032', '0.205', '0.050', '0.181', '0.095', '0.053', '0.058', '0.036', '0.028', '0.205'], tau: 2.020
2025-09-03 16:14:19,833 - __main__ - INFO - Fold 1 individual test signals: count=12, lengths=[176, 176, 176], magnitudes=[73.30146543155178, 70.37852643850931, 70.64573264787128]
2025-09-03 16:14:19,833 - __main__ - INFO - Fold 1 signal stats: mean=0.035156, std=0.478548, sum=6.187450, magnitude=69.137421
2025-09-03 16:14:19,834 - __main__ - INFO - [Fold 2] Training data: X_tr(352, 50), y_tr(352,)
2025-09-03 16:14:19,834 - __main__ - INFO - [Fold 2] Target stats: mean=-0.000131, std=0.002098
2025-09-03 16:14:19,835 - __main__ - INFO - [Fold 2] Feature stats: 227.630448 total magnitude
2025-09-03 16:14:48,300 - __main__ - INFO - Fold 2 XGBoost predictions: train_preds count=50, test_preds count=50
2025-09-03 16:14:48,300 - __main__ - INFO - Fold 2 test prediction stats: model_0: mean=-0.000203, std=0.000894, range=[-0.003193, 0.001902]; model_1: mean=-0.000721, std=0.001269, range=[-0.004606, 0.002899]; model_2: mean=-0.000380, std=0.000722, range=[-0.002604, 0.001608]
2025-09-03 16:14:55,036 - __main__ - INFO - Fold 2: Selected 12 models, weights: ['0.188', '0.000', '0.319', '0.000', '0.000', '0.173', '0.000', '0.000', '0.319', '0.000', '0.000', '0.000'], tau: 0.284
2025-09-03 16:14:55,036 - __main__ - INFO - Fold 2 individual test signals: count=12, lengths=[176, 176, 176], magnitudes=[92.6164359742393, 87.35411487842006, 88.12653655786987]
2025-09-03 16:14:55,037 - __main__ - INFO - Fold 2 signal stats: mean=-0.067697, std=0.488437, sum=-11.914753, magnitude=72.449782
2025-09-03 16:14:55,038 - __main__ - INFO - [Fold 3] Training data: X_tr(528, 50), y_tr(528,)
2025-09-03 16:14:55,038 - __main__ - INFO - [Fold 3] Target stats: mean=-0.000327, std=0.003058
2025-09-03 16:14:55,039 - __main__ - INFO - [Fold 3] Feature stats: 224.610396 total magnitude
2025-09-03 16:15:26,550 - __main__ - INFO - Fold 3 XGBoost predictions: train_preds count=50, test_preds count=50
2025-09-03 16:15:26,551 - __main__ - INFO - Fold 3 test prediction stats: model_0: mean=-0.000780, std=0.001868, range=[-0.006724, 0.003967]; model_1: mean=-0.000374, std=0.002250, range=[-0.008726, 0.008317]; model_2: mean=-0.000475, std=0.001569, range=[-0.004393, 0.003543]
2025-09-03 16:15:33,749 - __main__ - INFO - Fold 3: Selected 12 models, weights: ['0.108', '0.020', '0.015', '0.227', '0.009', '0.262', '0.012', '0.006', '0.006', '0.295', '0.034', '0.006'], tau: 1.020
2025-09-03 16:15:33,749 - __main__ - INFO - Fold 3 individual test signals: count=12, lengths=[176, 176, 176], magnitudes=[96.46225391830976, 86.97475027084784, 94.31571484404932]
2025-09-03 16:15:33,750 - __main__ - INFO - Fold 3 signal stats: mean=0.000435, std=0.482846, sum=0.076625, magnitude=69.544751
2025-09-03 16:15:33,751 - __main__ - INFO - [Fold 4] Training data: X_tr(704, 50), y_tr(704,)
2025-09-03 16:15:33,751 - __main__ - INFO - [Fold 4] Target stats: mean=-0.000310, std=0.003725
2025-09-03 16:15:33,752 - __main__ - INFO - [Fold 4] Feature stats: 224.775387 total magnitude
2025-09-03 16:16:07,752 - __main__ - INFO - Fold 4 XGBoost predictions: train_preds count=50, test_preds count=50
2025-09-03 16:16:07,752 - __main__ - INFO - Fold 4 test prediction stats: model_0: mean=-0.000027, std=0.001959, range=[-0.005075, 0.007995]; model_1: mean=0.000025, std=0.002276, range=[-0.005413, 0.006641]; model_2: mean=-0.000171, std=0.001924, range=[-0.005842, 0.009041]
2025-09-03 16:16:15,226 - __main__ - INFO - Fold 4: Selected 12 models, weights: ['0.416', '0.120', '0.003', '0.331', '0.020', '0.003', '0.026', '0.059', '0.010', '0.004', '0.003', '0.005'], tau: 0.809
2025-09-03 16:16:15,227 - __main__ - INFO - Fold 4 individual test signals: count=12, lengths=[176, 176, 176], magnitudes=[85.34694654830648, 87.8167937165465, 87.15354818944456]
2025-09-03 16:16:15,228 - __main__ - INFO - Fold 4 signal stats: mean=-0.047420, std=0.398513, sum=-8.346003, magnitude=56.864576
2025-09-03 16:16:15,229 - __main__ - INFO - [Fold 5] Training data: X_tr(880, 50), y_tr(880,)
2025-09-03 16:16:15,229 - __main__ - INFO - [Fold 5] Target stats: mean=-0.000315, std=0.003836
2025-09-03 16:16:15,229 - __main__ - INFO - [Fold 5] Feature stats: 224.075127 total magnitude
2025-09-03 16:16:49,403 - __main__ - INFO - Fold 5 XGBoost predictions: train_preds count=50, test_preds count=50
2025-09-03 16:16:49,403 - __main__ - INFO - Fold 5 test prediction stats: model_0: mean=-0.000235, std=0.001864, range=[-0.004750, 0.004250]; model_1: mean=-0.000338, std=0.002366, range=[-0.007746, 0.008961]; model_2: mean=-0.000266, std=0.001500, range=[-0.005296, 0.005225]
2025-09-03 16:16:57,178 - __main__ - INFO - Fold 5: Selected 12 models, weights: ['0.025', '0.013', '0.009', '0.227', '0.046', '0.196', '0.024', '0.248', '0.031', '0.009', '0.038', '0.133'], tau: 0.785
2025-09-03 16:16:57,178 - __main__ - INFO - Fold 5 individual test signals: count=12, lengths=[177, 177, 177], magnitudes=[90.16708081963688, 95.00416573605037, 91.04506512708303]
2025-09-03 16:16:57,179 - __main__ - INFO - Fold 5 signal stats: mean=-0.059876, std=0.452852, sum=-10.598002, magnitude=66.896846
2025-09-03 16:16:57,179 - __main__ - INFO - \U0001f4cb Processing complete: 6 fold summaries created
2025-09-03 16:16:57,179 - __main__ - INFO - \U0001f4ca OOS signal magnitude: 429.5910527544
2025-09-03 16:16:57,180 - __main__ - INFO - OOS DAPY(hits): 41.25 | OOS IR: 0.73 | OOS hit-rate: 0.582
2025-09-03 16:16:57,203 - __main__ - INFO - Calculating comprehensive performance metrics...
2025-09-03 16:16:57,205 - __main__ - ERROR - \u274c Error processing @TY#C: 'gbk' codec can't encode character '\U0001f4c8' in position 160: illegal multibyte sequence
2025-09-03 16:16:57,207 - __main__ - INFO - 
================================================================================
2025-09-03 16:16:57,207 - __main__ - INFO - \U0001f4ca FINAL SUMMARY: 0/1 targets completed successfully
2025-09-03 16:16:57,207 - __main__ - INFO - ================================================================================
GPU acceleration enabled for XGBoost
OOS Shuffling p-value (DAPY): 0.0049751244 (obs=41.25)
